<?php

use App\Libreria\Libreria;
use App\Models\{ClienteNota, Funciones};


$NOTA_V = new ClienteNota();
$FUNC = new Funciones();


$nota_cliente = $NOTA_V->mostrar_nota($id_nota); //LEE LA NOTA

$productos = json_decode($nota_cliente['productos'], true); //DECODIFICA LOS PRODUCTOS 

$cliente = $NOTA_V->mostrar_cliente($nota_cliente['id_cliente']);
$pagos = $NOTA_V->mostrar_pagos($nota_cliente['id_nota_cliente']);




/********************************** */ /********************************** */ /********************************** */
/********************************** */ /********************************** */ /********************************** */



$hoy = date("d") . " de " . $FUNC->meses(date('m')) . " de " . date("Y");
$mes = $FUNC->meses(date('m'));

$fila = '';
$total = 0;
$cuerpo_productos = '';
$fila_ac = 850;
$fila_ac_dos = 30;
$productoLength = sizeof($productos);
foreach ($productos as $i => $producto) {
    $sub_total = floatval($producto['cantidad']) * floatval($producto['precio_venta']);
    $total += $sub_total;
    $fila_ac += 30;
    $cuerpo_productos .= '^FO10,' . ($fila_ac) . '^A0,25^FD' . $producto['cantidad'] . '^FS';
    $cuerpo_productos .= '^FO40,' . ($fila_ac) . '^A0,25^FD' . '   x  $ ' . number_format($producto['precio_venta'], 2) . '^FS';
    $cuerpo_productos .= '^FO200,' . ($fila_ac) . '^A0,25^FD' . $producto['nombre'] . '^FS';
    $cuerpo_productos .= '^FO450,' . ($fila_ac) . '^A0,25^FD $ ' . number_format($sub_total, 2) . '^FS';
}

$descuento = $nota_cliente['descuento'];

$sub_total = $total;
$total = $total - $descuento;

$fila_ac += 30;
$cuerpo_productos .= '^FO10,' . ($fila_ac) . '^A0,25^FD Subtotal = $' . number_format($sub_total, 2) . '^FS';
$fila_ac += 30;
$cuerpo_productos .= '^FO10,' . ($fila_ac) . '^A0,25^FD Descuento = $' . number_format($descuento, 2) . '^FS';
$fila_ac += 30;
$cuerpo_productos .= '^FO10,' . ($fila_ac) . '^A0,25^FD Total = $' . number_format($total, 2) . '^FS';
$fila_ac += 200;
$cuerpo_productos .= '^FO10,' . ($fila_ac) . '^A0,25^FD     ***********************************^FS';
$fila_ac += 30;
$cuerpo_productos .= '^FO10,' . ($fila_ac) . '^A0,25^FD                                 FIRMA  ^FS';
$fila_ac += 30;
$fila_ac += 30;
$cuerpo_productos .= '^FO10,' . ($fila_ac) . '^A0,25^FD                      WWW.ROPONDAGAR.COM  ^FS';
$cuerpo_cliente = '
    ^FO10,540^A0,25^FDNombre:^FS
	^FO10,570^A0,25^FD' . $cliente['razon_social'] . '^FS
	^FO10,600^A0,25^FDTeléfono:^FS
	
	^FO10,660^A0,25^FDCorreo:^FS
    ^FO10,690^A0,25^FD' . $cliente['correo'] . '^FS';
$ll = $fila_ac + 200;
$ZPL_FORMAT = '^XA
	^CI28 Aplica el lengua español al ticket
    ^PW609
    ^POI
    ^LL' . $ll . '
	^FO5,5^GFA,20064,20064,76,,:::::::::::::::::::gY01,gV0LF,gT01NF8,gS0QFE,gR07RF,gP01TFC,gP07UF8,gO07VFC,gN07WFE,gM03YF8hP018gH038308S03031,gL03gFCgX01FCO03gI0383D8S0307F,gL0gGFEgX03FFO06gK047V046,gJ01gIF8gW03838,gJ07gIFCgW03838,gI01gJFEgW03818,gH01QF8I01PFgW038180F819E01F033C0033C03E0643F800678384F80FC0060600CF0309F01F8,gH07PFN0NF8gV038183DC1F703B83EE003DE07F07C73C007BC38FBC1DE0060600FB830FF83BC,gG01OFCO03MF8gV0383830C1C3070C382003860E38F060C0070C38E1C1860060E00E1830C3830C,gG07NFEQ0MFCgV0383070E1C18E0C383003870C38E060C0060C38C0C3070070E00C1830C1820C,g03OF8Q03LFEgV03FE06061818E06383003830038EI0E0060C38C0C3030070C00C1C30C1C00E,g0OF8S0MFgV03FE06061818E06383003830038EI0E00E0C38C0C3030030C00C0C30C1C00E,Y01MFEU03LF8gU038386061818C063830038300F8E007E0060C38C0C3030039C00C0C30C1C07E,Y03MF8V0LF8gU038386061818C063830038307F8E03FE0060C38C0C3030039800C0C30C1C1FE,Y0NF03FT07KFCgU038186061818C06383003830E38E070E0060C38C0C3030019800C0C30C1C30E,X0NF81FFCS03KFCgU0381C6061818E06383003831C18E0E0E0060C38C0C303001B800C0C30C1C60E,W01MF803FFES01KFEgU0381C6061818E06383003831C18E0E0E0060C38C0C303001FI0C0C30C1C60E,W07MF003IFT0KFEgU0381C70E1C1860C383003871C38E0E0E0060C38C0C307I0FI0C0C30C1C60E,W0MFC007IF8S07KFgU0381C30E1C3070C383003871C78E0E1E0060C38C0C106I0FI0C0C30C1C71E,V03LFEI07IFCS07KFgU0381C1F81FE03B8383003FE0F98E07EE00E0C38C0C0FCI0EI0C0C30C1C3EE,V0LFEJ07IFES03KF8gY07018C00EL03B803004038L01K07J06K082J01C,U03LF8J0JFES01KFChG018P038gL06,U0MFK0KFS01KFChG018P038gL0E,T03LFCK0KFS01KFChG018P038gL0C,S01MF8K0KFS01KFChG018P038gK01C,S03LFCL0KFS01KFChG018P038gK078,S07LFM0KFS01KFCj07,S0LFEL01KFQ0401KFC,R01LF8M0KFP07F80KFC,R03KFEM01KFO01FFC0KFC,R07KF8M03KFO07FFE0KFC,R0LFN03KFN01IFE0KFC,Q03KFCN03JFEN07IFE0KFC,Q07KFO07JFEN0JFE0KFCT03FFChH07FF8,P01KFCN01KFCM03JFE0KFCS03JFhG07IFE,P03KF8N03KFCM0KFE1KFCR01KFh03KF,P07KFO07KF8L03KFE1KFCR07KF8gY07KF,P0KFEO0LF8L0LFC1KFCQ01LF8gX01LF,O01KFCN01LFL01LFC3KFCQ03LF8gX03LF8,O01KF8N01KFEK03MF83KFCQ0MF8gW01MF8Y0E0C38,O07KFO01KFEJ01NF03KFCP03MF8g01V07MF8W07NF8,O07JFCO03KFCI03NFE03KFCP0NF8Y07FEU0NFW0QFE,O0KF8O03KFC001OFC03KFCO03NF8X03IF8S03NFU03SF8,N01KFP07KFC00PF803KFCO07NF8W01JFCS07NFS07VF,N03JFEP0LF80PFE007KFCN01OFX07JFCR01OFR0XFC,N03JF8P0LF07PFC007KFCN07OFX0KFCR03NFEP03gF,N0KFP01XFI07KF8N0LFE3FEW07KFER0MF3FEO03gGF8,M01JFEP03WFCI0LFN01LF07FEV01LFEQ01LF07FEN01gHFC,M03JFCP0XFJ0LFN07KFC0FFCV0MFEQ0LF80FFCM07gIFE,M03JFCP0WF8J0LFM01LF01FFCU03MFEP01LF01FF8L03gKF,M07JF8O01VFCK0LFM03KFE03FF8U0NFEP03KFC03FF8L0gLF,M0KFP01UFEL0KFEM07KF807FF8T01NFCP07KF807FFL03gLF,M0KFP03UFL01KFEL01LF00IFU07NFEO01LF01IFL07OF8001E1BPF8,L01JFEP0SF7EM01KFEL03KF801IFU0OFEO07KF803FFEL0MFCP03NF8,L01JFEN01SFEO03KFCL0LF003FFET03OFCO0LF007FFEK01LFT03LFC,L01JFEM03SF8P03KFCK01KFE007FFET0PFCN01KFE007FFCK03KFE001FCO01LFC,L01JFEL01SFEQ03KFCK07KFC00IFCS01LFE3FF8N07KF800IF8K07JFEI03FEP03KFC,L03KFK0TFER07KF8K0KFEI0IF8S07LF87FF8N0KFEI0IF8K07JF8I07FF8P0KFC,L03KFC00UFES0LF8J01KFCI0IF8R01LFE0IFN01KFCI0IFL0JFEJ0IFCP03JFC,L03gHF8S01LFK03KFJ0IFS07LFC1IFN07KFI01IFL0JFCJ0IFCQ0JFC,L03gFEU03LFK0KFEJ0IFS07LF03FFEN0KFCI01FFEL0JF8J0IFEQ07IFC,L03gFV03KFEJ01KF8J0FFER01LFC0IFCM03KF8J0FFCL0IFEJ01IFEQ07IF8,L03YFEV07KFCJ07JFEK0FFCR07LF01IF8M07KFK0FFCL0IFCJ01IFEQ07IF8,L01YFCV07KFCJ0KFCK07F8R0LFC01IFM01KFEK07F8L07FF8J01IFEQ0JF8,M0YFCV07KF8I01KFCK07FCQ03LF801IFM03KFCK0FFCL03FEK03IFEP03JF,M07XF8V07KF8I03KFK01FFEQ07KFE003FFEM07KFK01FFEL01F8K03IFEO01KF,M03XFW0LFJ0KFCK03IFQ0LFC003FFEM0KFCK03FFET07IFEO07JFE,N0WFEV01LFI01KF8K07IFP01LFI03FFCL01KF8K07IFT07IFEN07KFE,N01NFECLFCV07KFEI03KF8K0JF8O07KFEI01FF8L03KFL0JFT0JFCM01LFE,O0MF380LFCV0LFEI07JFEK01JF8N01LFCJ0FFM07JFEL0JFT0JFCM07LFC,P07JFE003LF8U01LFEI0KFCK01JF8N03LFK07EM0KF8K01JFS01JF8L03MF8,P03FFE3I07LFV01LFE001KFL03JF8N03KFES01KFL03JFS03JFL03NF8,Q018K0LFEV01LFC003JFEL07JFO07KF8S03JFEL07JFS03IFEK01OF,W01LFCV03LF8007JFCL0JFEO0KFET07JFEL0JFES07IFCJ03OFC,W03LF8V07LFI0KF8L0JFCN01KF8T0KF8K01JFCS0JFCJ0PF8,W07LFW0LFE001KFL03JF8N07JFEK0FCM03KFL07JFCR03JF8007QF,W0LFEV01LFC003JFEL07JF8M01KFCJ03FEM07JFEL07JF8R03JF03RFE,V01LFCV01LFC007JFCL0KFN01KF8J07FEM0KF8L0KF8R07JF1SF8,V03LFCV03LF800KF8K01KFN03KFK0IFL01KFL03KFS0XFE,V03LFCV0MF001KFL03JFEN07JFEJ01IFL03KFL07KFR01XF8,V07LFCV0LFE007JFEL07JFEM01KFCJ03IF8K03JFEL07JFER03WFC,V07LF8U01LFC00KFCL07JFEM03KFK0JF8K07JFCL0KFCR07VFE,V0MFV03LF800KFCL0KFCM07KFK0JF8K0KF8L0KFCR07UFE,U01LFEV0MF001KF8K01KFCM0KFEJ01JF8J01KFL03KF8R0VF,U07LFCU01MF001KFL03KF8L01KFCJ03JF8J03JFEL03KFR01UFC,U0MF8U01LFE003JFEL07KFM03KF8J07JF8J07JFCL07KFR03TFE,U0MFV03LFC007JF8L0KFEM07JFEK07JF8J0KF8L0KFER03RFE8,T01LFEV07LF800KF8K01KFEM0KFCK0KF8I01KF8K01KFEQ01RFC,T01LFCU01MF001KFL01KFEM0KF8J01KF8I03KFL03KFCQ07QFE,T03LFV07LFC003JFEL03KFCL03JFEK03KFJ07JFEL07KFCP03QF,T0LFEU01MF800KF8K01LF8L07JFCK0KFEJ0KF8K01LF8O07PF6,T0LFCU03MF001KF8K03LFM0KFCJ01KFEI01KF8K07LFO01PF,S01LFCU07LFE003KFL07KFEL01KF8J03KFCI03KFL07KFEO07OF8,S03LF8U0MF8007JFEL07KFEL03KFK0LFCI07JFEL0LFCO0OF,S07LFU03MFI07JFCL0LFCL07JFCK0LF8I0KF8K01LFCN03NFC,S0LFET01MFEI0KF8K03LFCL0KF8J01LF8I0KF8K03LFCN0NF8,R01LFET03MFC001KF8K07LF8L0KFK03LF8001KFL07LF8M01NF,R01LFCT07MF8003KFL07LFL01JFEK07LFI03KFL0MFN03MFE,R03LF8S01NFI07JFEL0LFEL03JFCK0LFEI03JFEL0LFEN07MFC,R07LF8S07MFEI07JFCK01LFCL03JF8J01LFCI07JFCK01LFCN07MFC,R0MFS03NFCI07JF8K03LF8L07JFK03LF8I0KFL03LFCN07MF8,Q01LFES0OF8I0KFL07LF8L0JFEK07LF8I0JFEL07LF8N07MF,Q01LFCR01NFCI01JFEL0MFL01JF8K0MFI01JFCL0MFO07LFE,Q07LF8R07NFJ01JF8K03MFL03JFK03LFEI03JF8K03MFO07LFC,Q0MF8Q03NFEJ03JFL07MFL07JFK07LFCI03JFL07MFO03LF8,P01MFR0OF8J07IFEL0NFL07IFEK0MF8I07IFEL0MFEO01LF,P01LFEQ03OFK0JFEK01MFEK01JFCJ01MFJ0JFEK01MFCP0KFE,P03LFCQ0OFEJ01JFEK03MFCK03JFCJ03LFEI01JFEK03MF8P0KFC,P07LF8P07OF8J03JFCK07MF8K07JF8J0MFC007KFCK0NFQ0KF8,P07LF8O01PFK07JF8K0NFL0KFJ01MFC00LF8J01MFEQ07JF8,P0MFP03OFCK07JF8J01MFEK01JFEJ03MF801LFK03MFCQ07JF,O01LFEP0PF8K0KFK07MFCK01JFCJ07MF007KFEK07MFCQ0JFE,O03LFCO07OFEK01JFEK0NFCK03JF8J0MFE03LFEK07MF8P01JFC,O07LF8N03PFCK01JFCJ01NF8I03C7JFJ01MFE0MFCJ01NF8I03CK01JFE,O0MF8N0QF8K03JF8J03NFJ07EJFEJ03MFC3MF8J03NFJ0FEK03JFE,O0MFN07PFEL03JFK07NFI01LFCJ07MFCNFK07MFEI01FEK07KF,N01LFEM03QF8L07IFEK0NFEI07LFCJ0NFDMFEK0NFEI07FEK07KF8,N03LFCJ01SFEM0JFCJ01JF7IFC001MF8I03VFCJ03JF7IFC001FFEJ01LFC,N07LF8J03SF8L01JFCJ03IFE7IFC003MFJ07VFCJ03IFE7IF8003FFCJ03LFE,N0MFJ01SFEM01JFCJ07IFCJF8007LFEI01IFC7RF8J07IFCJF8007FFCJ07MF,M01MFJ0TF8M01JF8J0JF8JF801MFCI03IFCSFJ01JF8JF801IF8J07MF,M03LFEI07SFEN01JFJ01JF0JF003MFCI07IFCSFJ03IFE0JF007IF8J0NFC,M03LFC07UF8N03JFJ03IFC1IFE007MF8I0JF9SFJ07IFC1JF00JFJ01NFC,M07gIFEO03IFEJ07IFC1IFE01NF8001JF3NF7IFEJ0JF83IFE01JFJ03JF9JF,M0gJF8O07IFCI01JF81IFC07NFI03IFC7MFE7IFEI01JF03IFE0JFEJ03JF8JF8,K010gIFEP07IFCI03IFE03IFC1NFEI07IFC7MFCJFCI03IFE03IFC3JFEJ07IFE0JF8,K0gKF8P07IF8I07IFC03IFC7NFCI0JF8MF80JFCI07IF807IFC7JFCJ0JFE07IFC,J03gJFEQ0JF8I0JF807IFDOF8001JF1MF00JF8I0JF807IF8KFJ01JFE07IFE,J07gJFR0JFI01JF807IFBOF8007IFC1LFE01JFI01JF007IFBJFEJ03JFC03JF,J0gJFEQ01JFI01JF007SFI0JF83LF801JFI03JF007NFCJ07JF803JF8,I01gJFR01JFI07IFE007NFBIFE001JF03KFE001IFEI07IFE007NFK0KF801JFC,I03gHFCS01IFEI0JF8007MFC3IFC007IFC07KFI03IFE001JF800NFEJ01JFEI07JF,I07gHFT03IFE003JF8007MF83IFC03JF80KFCI03IFC007JF8007MF8J03JFEI07JF,I07gGFCT03IFE00KFI07LFE07IF807JF03KF8I07IFC00KFI07LFEK03JFCI03JF8,I0gHFU07IFC01JFCI07LF807IF81JFC07JFEJ07IFC01JFCI07LF8K07JF8I01JFC,I0gFEV07IFC07JF8I07LF007IF83JF80KF8J07IFC07JF8I07LFL07JFK0JFE,I0YFEW07IF80KF8I03LF00JF07JF03KFK0JF80KFJ07KFEL0KFK0JFE,I0YFCW07IF83KFJ03KFC00IFE1JFE07JFCK0JF81JFEJ07KFCL0JFEK07JF,I07VFCY07IF87JFCJ03JFEI0IFE7JFC0KF8K0JF07JFCJ03JFEL01JFCK07JF8,I07UF8g0JF8KF8J01JFCI0OF03KF8K0JF1KF8J01JF8L01JF8K03JFC,I03UFgG0PFL0JFJ0NFE07KFL0PFL0JFM01JF8K01JFE,I03RF6FEgG0OFEL0IFCJ0NFC0KFEL0OFEL0IFEM01JFL01KF,I01QFCgJ0OFCL03FF8J07MF81KFCL0OFCL03FF8M01JFM0KF8,J07OFEgK07NF8L01EL07LFE03KF8L0OF8L01CO01IFEM0KFC,K03LFEgM07MFEU03LFC07KFM0NFEX01IFEM0KFE,L01IFgP07MFCU01LF03LFM07MFCX01IFCM07KF,h03MF8V0KFC07KFEM07MFg0IFCM03KF8,h03LFEW07JF81LFCM03LFEg0IF8M01KFCN0FC,h01LFCW03JF83LFCM01LFCg0IF8N0KFEM07FF8,hG0LF8W01IFE07LF8M01LFgG07FFO0KFEM0E01C,hG0KFEY01FE00MFO0KFEgG01FEO07KFL018006,hG07JFCgI01MFO07JF8gS03KF8K03I03,hG03JFgJ03LFEO03JFgT03KFCK06I018,hH0IFCgJ07LFCP0IFCgT01KFEK0EJ0C,hH07FEgK0MFCP07FCgV0LFK0F06FCC,hI06gK01MF8Q08gW07KFJ01906846,iO03MFhP03KF8I01906826,iO07LFEhP03KFCI0110E822,iN01MFChP01KFCI0318A802,iN03FFE7IFChQ0LFI0308AFC2,iN07FFC7IF8hQ0LF8003082982,iN0IF8JFhR0LFC003052882,iM01IF9JFhR07KFC001052842,iM03IF3IFEhR03KFE001852846,iM07FFE7IFEhR03KFE001862806,iL01IFCJFChR01LFI0C62824,iL01IF0JF8hS0LFI0EI01C,iL03FFE1JFhT0LFI06I018,iL07FFC3IFEhT07KFI06I03,iL07FF87IFChT03JFEI03I03,iL0IF0JFChU0JFEI01C00C,iK01FFE1JF8hU0JFEJ0F878,iK03FFC3JFhV0JF8K0FC,iK0IF87IFEhV07FFE,iK0IF0JFChV01FFC,iJ01FFE0JF8hW07F,iJ03FFC1JF,iJ07FF81JF,iJ07FF03IFE,iJ0IF07IFC,iI01FFE0JFC,iI03FFE1JF8,iI07FFC3JF,iI07FFC7IFE,iI0IF8JFC,iI0IF0JF8,iH01FFE1JFh018N06T0E1C006K01C,iH03FFC1IFEV01FCgG018N06T0EJ06K01C,iH07FF83IFCV038EM018R018N060CR0EJ06K01C,iH0IF07IF8V0707M018R018N060CR0EJ06K01C,iH0IF0JF8V0603M018R018N060CR0EJ06K01C,iH0FFE1JFW0E03M01CR018N060ER0EJ06K01C,iG01FFE3IFEW0EI03E01F07F7071981FI07D81FI03F063F87EI07C07E0E1C3E60FC07DC,iG01FFC3IFCW0EI07F03B87E7071F87B800F783B80073863F0E7001EC0E70E1C3BE1CE0F7C,iG01FFC7IF8W0EI0E3871C187071E061800C3830C00E1860C1C3801861C30E1C70E1870C3C,iG03FF8JFX0EI0C1860C187071C061C00C1860C00C1C60C183803821830E1C6063830C1C,iG07FF9IFEX0E001C1C6001870718001C0081860EI01C60C003803020010E1CE06003081C,iG07LFCX0E001C0C7001870718001C0081860EI01C60C001803J010E1CE06003081C,iG0MF8X0E001C0C3C0187071800FC018187FE001FC60C01F803I03F0E1CE0603F181C,iG0MFY0E001C0C0F0187071803FC018187FC007FC60C0FF803I0FF8E1CE061FF181C,iG0LFCY0E001C0C01818707180E1C018186J0C1C60C181803001C38E1CE06383181C,i01LF8Y0E031C1C00C18707180E1C008186I01C1C60C381803003818E1CE06303081C,i01LFg06030C1C60C18707180C1C008186I01C1C60C383803023830E1CE06303081C,i01KFEg07070E1860C1C307180E1C00C383I01C3C60E183801861838E1C70E3070C3C,i01KFEg038E073071C1C38F180F3C00E7838C00E7C60E1C7801C61C78E1C79E38F0E3C,i01KFCg01FC03E03F80F1F31807CC007D81FC00FCC6078F9800FC0F98E1C3F61F307D8,iG0KF8gG07I080060060EJ018I03I06I03J0306J03807L0C00E0038,iG0KF,iG0JFE,iG0JFC,iG0JF,iG0IFE,iG07FFC,iG03FC,iH03,,:::::::::::::::::::^FS
    ^FO10,250^A0,30^FDRazón  Social:  Disenos  Dagar^FS
	^FO10,280^A0,30^FDRFC: AOGA7305111C3^FS
	^FO10,310^A0,30^FDDomicilio:  Prol.  Macías  No  #212^FS
	^FO10,340^A0,30^FDCódigo  Postal:  47140^FS
	^FO10,370^A0,30^FDColonia:  Sagrada  Familia^FS
	^FO10,400^A0,30^FDCiudad:  San  Miguel  el  Alto^FS
	^FO10,430^A0,30^FDTeléfono:  +52-347-107-4907^FS
	^FO10,460^A0,25^FD--------------------------------^FS
	^FO10,480^A0,25^FD                      		CLIENTE^FS
	^FO10,510^A0,25^FD--------------------------------^FS
	' . $cuerpo_cliente . '
	^FO10,730^A0,25^FD---------------------------------^FS
	^FO10,760^A0,25^FD						TICKET:' . $FUNC->rellenar_cero($nota_cliente['id_nota_cliente'], 6) . '  ^FS
	^FO10,790^A0,25^FD      			Fecha: ' . $hoy  . '^FS
	^FO10,820^A0,25^FD---------------------------------^FS
	^FO10,850^A0,25^FDCTD    PRECIO       DESCRIP                         SUBTOTAL^FS
	' . $cuerpo_productos . '
	^XZ';

function EscribirNota($nota_body, $archivo)
{
    $datos = $nota_body;
    try {
        $archivo_save = fopen($archivo, "a") or die("Error al crear el archivo");
        fwrite($archivo_save, $datos);
        fclose($archivo_save);
    } catch (\Throwable $th) {
        var_dump($archivo_save);
        die("Imposible abrir el archivo");
    }
}

$dir = '../public/';
$documento = $nota_cliente['uuid'] . '_venta.zpl';
$dir_cliente = "documentos/ventas/" . $cliente['id_cliente'] . '/';

if (!file_exists($dir . $dir_cliente)) {
    mkdir($dir . $dir_cliente, 0777) or die(json_encode(array('respuesta' => 'error', 'Texto' => "No se puede crear el directorio de extracción")));
}

EscribirNota($ZPL_FORMAT, ($dir . $dir_cliente . $documento));


$fichero = $dir . $dir_cliente . $documento;

if (file_exists($fichero)) {
    header('Content-Description: File Transfer');
    header('Content-Type: application/octet-stream');
    header('Content-Disposition: attachment; filename="' . basename($documento) . '"');
    header('Expires: 0');
    header('Cache-Control: must-revalidate');
    header('Pragma: public');
    header('Content-Length: ' . filesize($fichero));
    readfile($fichero);
    exit;
}
?>

<!-- $respuesta = [
    'response' => 'success',
    'text' => 'Ticket para Zebra ZQ630',
    'data' => ["link" => ($RUTA . $documento)],
];

die(json_encode($respuesta)); -->